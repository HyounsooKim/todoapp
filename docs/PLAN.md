# ToDo Java Desktop App — 개발 Plan(정리본)

이 문서는 “Windows 로컬에서 동작하는 데스크톱 ToDo 앱”을 만들기 위해 대화에서 합의된 요구사항/결정/진행 순서를 다음 개발에서도 그대로 재사용할 수 있도록 정리한 Plan입니다.

## 1) 목표(Goal)
- Windows 11 로컬에서 실행되는 데스크톱 ToDo 앱을 만든다.
- 캘린더 기반 UX로 날짜별 ToDo를 빠르게 확인/편집한다.
- 데이터는 로컬 파일 DB로 영속 저장되며(네트워크/클라우드 의존 없음), 설치본 업그레이드(덮어설치)에서도 데이터 보존을 우선한다.

## 2) 기술 스택(Tech)
- 언어/런타임: Java 21
- 빌드: Maven(+ Maven Wrapper)
- 앱 프레임워크: Spring Boot (non-web) + Spring Data JPA/Hibernate
- DB: H2 (파일 DB)
- UI: JavaFX (FXML 미사용, 코드 기반)
- 패키징: jlink + jpackage
  - MSI/EXE는 WiX Toolset(candle/light) 필요

## 3) UX 요구사항(확정)

### 전체 레이아웃
- 좌측: 월간 캘린더
- 우측 상단: 선택 날짜의 ToDo 제목 리스트
- 우측 하단: 상세(제목/내용/완료 체크 + Save)

### 캘린더 마커 규칙
- 특정 날짜에 ToDo가 존재하면 날짜 칸에 동그라미 표시
  - 미완료 ToDo가 하나라도 있으면: 주황
  - 해당 날짜의 ToDo가 전부 완료면: 녹색

### 목록/상세 동작
- 날짜 선택 시: 우측 목록은 “제목 리스트만” 표시
- 목록 항목 클릭 시: 상세 영역에 내용 표시 + 수정 가능
- 완료 항목 표현: 취소선 사용하지 않고 “밝은 회색(텍스트)”로 표시

### 저장 정책(중요)
- 편집은 즉시 저장되지 않는다.
- 사용자가 반드시 `Save` 버튼을 눌러야 저장된다(명시적 저장).
- 삭제는 즉시 반영(즉시 삭제).

## 4) 데이터/경로 정책

### 개발 실행 시
- 기본 DB 위치: 프로젝트 폴더 하위 `./data/`

### 설치본 실행 시(권한/업그레이드 고려)
- 기본 DB 위치: `%LOCALAPPDATA%\TodoApp\data\`
- 설치 경로(Program Files 등) 쓰기 권한 문제를 피하기 위해 사용자 쓰기 가능 경로를 사용한다.

### 언인스톨 정책
- 기본: 앱 제거 후에도 `%LOCALAPPDATA%\TodoApp\data\` 데이터는 남겨서 재설치/업그레이드 시 보존
- 완전 삭제: 사용자 수동 폴더 삭제

## 5) 개발 순서(Workflow)

### A. 스캐폴딩
- Spring Boot(비웹) + JPA + H2 + JavaFX 의 기본 골격을 먼저 만든다.
- 최소 기능(날짜 선택, 목록, 상세, 저장/삭제)부터 엔드투엔드로 동작시키고, 그 다음 캘린더 마커/완료 표시 등을 완성한다.

### B. 실행/테스트 자동화(Windows/VS Code 환경)
- Maven Wrapper를 포함해 환경 의존을 줄인다.
- VS Code 터미널에서 JAVA_HOME/Path 문제가 있어도 실행되도록 PowerShell 스크립트를 제공한다.
  - `run.ps1`: 실행
  - `test.ps1`: 테스트

### C. 패키징(배포)
- 빌드 산출물 생성 → 의존성 수집 → jlink로 런타임 이미지 생성 → jpackage로 패키징
- `package.ps1`로 위 과정을 자동화한다.
- MSI 업그레이드를 위해 `--win-upgrade-uuid`는 고정 값으로 유지한다(덮어설치 경로 안정화).

## 6) 품질/검증(Definition of Done)
- 기능
  - 캘린더 마커(주황/녹색) 규칙이 정확히 동작
  - 날짜 선택 → 목록 갱신
  - 목록 클릭 → 상세 표시
  - 편집 후 Save를 눌러야만 DB 반영
  - 삭제는 즉시 반영
- 테스트
  - 단위 테스트 통과(`TodoServiceTest` 등)
- 패키징
  - `package.ps1 -Type msi`로 MSI 생성 가능
  - 다른 Windows PC에서 설치/실행 가능
- 업그레이드
  - v1.0.0 설치 후 데이터 생성
  - v1.0.1(또는 그 이상) 덮어설치 후 데이터 유지 확인

## 7) 결정 기록(중요 변경/이슈 대응)
- H2 2.2.x에서 일부 URL 옵션 조합이 실패할 수 있어(Feature not supported) DB URL은 단순화하는 쪽으로 정리
- JavaFX UI에서 NPE가 발생했던 조기 초기화 코드는 제거
- WiX가 설치되어도 PATH에 candle/light가 없을 수 있어 `package.ps1`에서 설치 경로 자동 탐지/임시 PATH 추가

## 8) 범위 밖(Non-goals)
- 웹 UI/서버 배포, 클라우드 동기화
- 자동 저장/자동 동기화(명시적 Save 정책을 유지)
- 복잡한 필터/태그/알림/반복 일정 등(요구가 생기면 별도 협의)
